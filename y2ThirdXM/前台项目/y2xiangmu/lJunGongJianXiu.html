<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
	<head>
		<meta charset="UTF-8">
		<title>竣工检修</title>
		<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css"/>
		<style>
			#bt{
				background:#4b6cb7;
			}
			
			#c{
				background:#bdc3c7;
			}
			
			#body{
				background:#f5f5f5;
			}
			
			#ctx1{
				background:#ffffff;
			}
			
		</style>
	</head>
	<body>
		<div id="body">
			<div id="bt"><!--1-->
			<div  class="row">
				<h3 class="col-xs-offset-1 col-xs-9">竣工检修</h3>
				<button type="button" class="btn btn-success col-xs-1" onclick="load()" style="margin: 14px 0 0;">查询</button>
				<button type="button" class="btn btn-default" style="margin: 14px 0 0 10px;">关闭</button>
			</div>
			<div  class="page-header" style="border-bottom: 1px solid blue;"></div>
			</div><!--1-->
			<div>
				<p>
					<div class="col-xs-3" style="width:20%;margin-bottom: 10px;">
						<div class="input-group">
							<span class="input-group-addon">业务类别</span>
							<input type="date" id="pretime" style="vertical-align: middle ; width:154px; height:33px;">
						</div>
					</div>
					<div class="col-xs-3" style="width:30%;margin-bottom: 10px;">
						<div class="input-group">
							<span class="input-group-addon">至</span>
							<input type="date" id="nexttime" style="vertical-align: middle ; width:154px; height:33px;">
						</div>
					</div>
					<div class="col-xs-3" style="margin-bottom: 10px;">
						<div class="input-group">
							<span class="input-group-addon">维修单号：</span>
							<input type="text" id="wxdanno" style="vertical-align: middle ; width:154px; height:33px;"/>
						</div>
					</div>
					<div class="col-xs-3" style="margin-bottom: 10px;">
						<div class="input-group">
							<span class="input-group-addon">单据状态：</span>
							<select id="danjustatu" style="vertical-align: middle ; width:154px; height:33px;">
								<option value="">全部</option>
								<option value="作业中">待竣工车</option>
								<option value="已竣工">已竣工车</option>
							</select>
						</div>
					</div>
					<div class="col-xs-12" style="margin-bottom: 10px;">
						<div class="input-group">
							<span class="input-group-addon">车牌号</span>
							<input type="text" id="chepai" style="vertical-align: middle ; width:154px; height:33px;"/>
						</div>
					</div>
				</p>
			</div>
			<div>
				<p style="margin-left:20px;font-size: 18px;">
					<a href="javascript:void(0)" onclick="toWeiXiuDan()"><span class="glyphicon glyphicon-share" aria-hidden="true"></span>打开单据</a>
				</p>
			</div>
			<div class="row" style="height: 380px;overflow: scroll;">
				<table id="ctx1" class="table table-hover table-bordered text-center " style="margin-left:20px;">
						<thead>
							<tr id="c">
								<th></th>
								<th class="text-center">维修单号</th>
								<th class="text-center">单据状态</th>
								<th class="text-center">业务类型</th>
								<th class="text-center">客户名称</th>
								<th class="text-center">车牌号</th>
								<th class="text-center">手机</th>
								<th class="text-center">会员卡号</th>
								<th class="text-center">单据类型</th>
								<th class="text-center">开单时间</th>
								<th class="text-center">预计完工</th>
								<th class="text-center">完工时间</th>
							</tr>
						</thead>
						<tbody>
							<tr onclick="zyzclTr(this)" v-for="item in zuoyezhong">
								<td><input type="radio" name="jungong" disabled="disabled"></td>
								<td class="text-center">{{item.wxdanno}}</td>
								<td class="text-center">{{item.danjustatu}}</td>
								<td class="text-center">{{item.yewutype}}</td>
								<td class="text-center">{{item.kehuname}}</td>
								<td class="text-center">{{item.chepai}}</td>
								<td class="text-center">{{item.lianphone}}</td>
								<td class="text-center">{{item.huiyuanno}}</td>
								<td class="text-center">{{item.wxdantype}}</td>
								<td class="text-center">{{item.kaidantime}}</td>
								<td class="text-center">{{item.yujitime}}</td>
								<td class="text-center">{{item.wangongtime}}</td>
							</tr>
						</tbody>
					</table>
			</div>
		</div>
	</body>
	
	<script type="text/javascript" src="js/jquery-3.4.1.min .js" ></script>
	<script type="text/javascript" src="js/vue.js"></script>
	<script type="text/javascript" src="js/bootstrap.min.js" ></script>
	<script type="text/javascript" src="js/my.js"></script>
	<script type="text/javascript">
	var vm = new Vue({
		el:"#body",
		data(){
			return {
				zuoyezhong:[],
				selectedwxdanno:"",
				selectedchepai:"",
			}
		}
	})
	
	var timeoutID =null;
	var vmindex = null;
	//页面加载事件
	load();
		function load(){
			$.ajax({
				"url":data.ip +"weixiujieche/queryJunGong",
				"data":"wxdanno="+$("#wxdanno").val()+"&chepai="+$("#chepai").val()+"&danjustatu="+$("#danjustatu").val()+"&pretime="+$("#pretime").val()+"&nexttime="+$("#nexttime").val(),
				"success":function(result){
					vm.zuoyezhong=result;
				},
				"error":function(){
					alert("数据渲染失败444！");
				}
			})
		}
	
		
		//
		function toWeiXiuDan(){
			var Myiframe=document.createElement("iframe");
			Myiframe.setAttribute("style","position:fixed;z-index:999;top:0px;left:0px;width:100%;height:100%;");
			Myiframe.src="lWeiXiuDan.html";
			Myiframe.id="weixiudan";
			var mybody=document.getElementById("body");
			if(vmindex==null){
				alert("未选中任何单据");
				Myiframe = null;
				mybody = null;
				return;
			}
			vm.selectedwxdanno = vm.zuoyezhong[vmindex].wxdanno;
			vm.selectedchepai = vm.zuoyezhong[vmindex].chepai;
			mybody.append(Myiframe);
		}
		
		//表单tr的单选，选中和取消
		function zyzclTr(zyItem){
			clearTimeout(timeoutID);
			timeoutID = window.setTimeout(function (){
				vmindex = $(zyItem).index();
				if($("[name='jungong']")[vmindex].checked){
					$("[name='jungong']")[vmindex].checked=false;
					vmindex = null;
				}else{
					$("[name='jungong']")[vmindex].checked=true;
				}
			},300);
		}
	</script>
</html>
