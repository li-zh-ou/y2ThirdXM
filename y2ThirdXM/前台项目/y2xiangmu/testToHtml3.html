<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
	<head>
		<meta charset="UTF-8">
		<title>接车登记</title>
		<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css"/>
	</head>
	<body>
					<div id="body">
					<button onclick="colseIframe()">确定</button>
						<table class="table table-hover table-bordered text-center ">
								<thead>
									<tr>
									    <th></th>
										<th>项目名称</th>
										<th>项目类型</th>
										<th>售价按</th>
										<th>原价</th>
										<th>vip价</th>
										<th>会员价</th>
										<th>协议价</th>
									</tr>
								</thead>
								<tbody>
									<tr v-for="item in data.list" onclick="trclick(this)">
										<td><input class="xmcheckbox" type="checkbox" disabled="disabled"/></td>
										<td>{{item.xiangmuname}}</td>
										<td>{{item.xingmutype}}</td>
										<td>{{item.shoujiaan}}</td>
										<td>{{item.price}}</td>
										<td>{{item.vipprice}}</td>
										<td>{{item.huiprice}}</td>
										<td>{{item.xieprice}}</td>
									</tr>
								</tbody>
						</table>
						<div class="btn-group" role="group" style="margin-left: 40%;">
							<button type="button" class="btn btn-default" @click="shoupage()">首页</button>
						  	<button type="button" class="btn btn-default" @click="nextpage()">《</button>
						  	<button type="button" class="btn btn-default">{{data.pageNum}}/{{data.lastPage}}</button>
						  	<button type="button" class="btn btn-default" @click="prevpage()">》</button>
						  	<button type="button" class="btn btn-default" @click="lastpage()">末页</button>
						</div>
			        </div>
	</body>
		<script type="text/javascript" src="js/jquery-3.4.1.min .js" ></script>
	<script type="text/javascript" src="js/vue.js"></script>
	<script type="text/javascript" src="js/bootstrap.min.js" ></script>
	<script type="text/javascript" src="js/my.js"></script>
	<script type="text/javascript">
		var vm =new Vue({
			el:"#body",
			data(){
				return {
					data:[],
					xiangmus:"",
				};
			},
			methods:{
				shoupage:function(){
					load(this.data.firstPage,14);
				},
				nextpage:function(){
					load(this.data.nextPage,14);
				},
				prevpage:function(){
					load(this.data.prePage,14);
				},
				lastpage:function(){
					load(this.data.lastPage,14);
				}
			}
		})
		function colseIframe(){
			var childIframe=window.parent.document.getElementById("addxiangmu");
			vm.xiangmus = window.parent.vm.xiangmus;
			 for(var i = 0;i<$(".xmcheckbox").length;i++){
				if($(".xmcheckbox")[i].checked){
					if(vm.xiangmus.indexOf(vm.data[i].wxxiangmuno+",")==-1){
						vm.xiangmus = vm.xiangmus + vm.data[i].wxxiangmuno+",";
					}
				}
			} 
			window.parent.vm.xiangmus=childIframe.contentWindow.vm.xiangmus;
			index = null;
			window.parent.queryWXxiangmu();
			childIframe.remove();
		}
		
		function trclick(obj){
			var index = $(obj).index();
			if($(".xmcheckbox")[index].checked){
				$(".xmcheckbox")[index].checked = false;
			}else{
				$(".xmcheckbox")[index].checked = true;
			}
		}

		function load(pageNum,pageSize){
			$.ajax({
				"url":data.ip+"weixiujieche/querywxXiangMu",
				"type":"post",
				"data":"pageNum="+pageNum+"&pageSize="+pageSize,
				"success":function(result){
					vm.data = result;
				},
				"error":function(){
					alert("渲染出错了！");
				}
			})
		}
		load(1,14);
	</script>
</html>
